import telebot
from datetime import datetime
import os
from dotenv import load_dotenv

# Load environment variables
load_dotenv()

# Get credentials from environment variables
TOKEN = os.getenv('TELEGRAM_BOT_TOKEN', '8583352280:AAEKrbrxN41W3557YhFuCRg37LQ_dvMkb1g')
ADMIN_IDS = [int(os.getenv('ADMIN_ID', '0'))]

bot = telebot.TeleBot(TOKEN)

# ============================================================
# –ö–û–ú–ê–ù–î–ê /start - –ì–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
# ============================================================
@bot.message_handler(commands=['start'])
def send_welcome(message):
    """–ì–ª–∞–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"""
    user_id = message.from_user.id

    # –°–æ–∑–¥–∞—ë–º –∫–Ω–æ–ø–∫—É –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    markup = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True)
    webApp = telebot.types.WebAppInfo(
        "https://ppl-ai-code-interpreter-files.s3.amazonaws.com/web/direct-files/1cba166588e51af668d0e7b4e5d393ef/3204afed-0e38-40e7-bd9a-7a0c3ae76af1/index.html"
    )

    markup.add(telebot.types.KeyboardButton(text="üöÄ –û—Ç–∫—Ä—ã—Ç—å Chain Pro", web_app=webApp))

    welcome_text = """
üéØ **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Legion Chain Score Pro!**

–í–æ—Ç —á—Ç–æ —Ç—ã –º–æ–∂–µ—à—å –¥–µ–ª–∞—Ç—å:
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—ã—à–∞–π Chain Score
‚úÖ –í—ã–±–µ—Ä–∏ –æ–¥–Ω—É –∏–∑ 3 –ø–æ–¥–ø–∏—Å–æ–∫
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 3 –±–ª–æ–∫—á–µ–π–Ω–æ–≤ (Arbitrum, Solana, Sui)
‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–π –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
‚úÖ –ü–æ–ª—É—á–∞–π –æ—Ü–µ–Ω–∫–∏ —É–ª—É—á—à–µ–Ω–∏—è Chain Score

–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å!
    """

    bot.send_message(
        message.chat.id, 
        welcome_text, 
        reply_markup=markup,
        parse_mode='Markdown'
    )

# ============================================================
# –ö–û–ú–ê–ù–î–ê /info - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–ø–∏—Å–∫–∞—Ö
# ============================================================
@bot.message_handler(commands=['info'])
def send_info(message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞–Ω–∞—Ö –ø–æ–¥–ø–∏—Å–æ–∫"""
    info_text = """
üíé **LEGION CHAIN PRO - –ü–û–î–ü–ò–°–ö–ò**

üìå **STARTER** - 700 ‚≠ê
‚îú‚îÄ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 7 –¥–Ω–µ–π
‚îú‚îÄ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: 120-150
‚îú‚îÄ Chain Score: +142 –±–∞–ª–ª–æ–≤
‚îú‚îÄ –ë–ª–æ–∫—á–µ–π–Ω: 1 –Ω–∞ –≤—ã–±–æ—Ä
‚îî‚îÄ –õ—É—á—à–µ –≤—Å–µ–≥–æ –¥–ª—è: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

üìå **PROFESSIONAL** - 1000 ‚≠ê (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
‚îú‚îÄ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 14 –¥–Ω–µ–π
‚îú‚îÄ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: 350
‚îú‚îÄ Chain Score: +400 –±–∞–ª–ª–æ–≤
‚îú‚îÄ –ë–ª–æ–∫—á–µ–π–Ω—ã: –í—Å–µ 3 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
‚îú‚îÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è
‚îî‚îÄ –õ—É—á—à–µ –≤—Å–µ–≥–æ –¥–ª—è: –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

üìå **ENTERPRISE** - 1500 ‚≠ê
‚îú‚îÄ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 30 –¥–Ω–µ–π
‚îú‚îÄ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: 1000+
‚îú‚îÄ Chain Score: +750 –±–∞–ª–ª–æ–≤
‚îú‚îÄ –ë–ª–æ–∫—á–µ–π–Ω—ã: –í—Å–µ 3 + –ú—É–ª—å—Ç–∏–∫–æ—à–µ–ª—å–∫–∏
‚îú‚îÄ –ü–æ–¥–¥–µ—Ä–∂–∫–∞: 24/7
‚îî‚îÄ –õ—É—á—à–µ –≤—Å–µ–≥–æ –¥–ª—è: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –±—É—Å—Ç–∞

üîó –û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É!
    """
    bot.send_message(message.chat.id, info_text, parse_mode='Markdown')

# ============================================================
# –ö–û–ú–ê–ù–î–ê /help - –°–ø—Ä–∞–≤–∫–∞
# ============================================================
@bot.message_handler(commands=['help'])
def send_help(message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã"""
    help_text = """
üìñ **–î–û–°–¢–£–ü–ù–´–ï –ö–û–ú–ê–ù–î–´**

/start - –û—Ç–∫—Ä—ã—Ç—å Legion Chain Pro
/info - –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏
/help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
/status - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
/support - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É
/admin - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)

üí¨ –í–æ–ø—Ä–æ—Å—ã? –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É /support
    """
    bot.send_message(message.chat.id, help_text, parse_mode='Markdown')

# ============================================================
# –ö–û–ú–ê–ù–î–ê /status - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏
# ============================================================
@bot.message_handler(commands=['status'])
def check_status(message):
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    user_id = message.from_user.id

    status_text = f"""
üë§ **–°—Ç–∞—Ç—É—Å —Ç–≤–æ–µ–π –ø–æ–¥–ø–∏—Å–∫–∏**

ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {user_id}
–°—Ç–∞—Ç—É—Å: –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
–ü–ª–∞–Ω: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
–î–Ω–µ–π –æ—Å—Ç–∞–ª–æ—Å—å: -

üí° –ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å:
1. –ù–∞–∂–º–∏ /start
2. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –í—ã–±–µ—Ä–∏ –ø–æ–¥–ø–∏—Å–∫—É
4. –û–ø–ª–∞—Ç–∏ Telegram Stars
5. –ù–∞—á–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é!
    """
    bot.send_message(message.chat.id, status_text, parse_mode='Markdown')

# ============================================================
# –ö–û–ú–ê–ù–î–ê /support - –ü–æ–¥–¥–µ—Ä–∂–∫–∞
# ============================================================
@bot.message_handler(commands=['support'])
def send_support(message):
    """–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ"""
    support_text = """
üÜò **–°–õ–£–ñ–ë–ê –ü–û–î–î–ï–†–ñ–ö–ò**

–î–ª—è –ø–æ–º–æ—â–∏:
üìß Email: support@legion.cc
üåê –°–∞–π—Ç: https://legion.cc
üí¨ Discord: [—Å—Å—ã–ª–∫–∞ –Ω–∞ Discord]
üì± Telegram: @LegionSupport

–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã:
‚ùì –ü–ª–∞—Ç—ë–∂ –Ω–µ –ø—Ä–æ—à—ë–ª? –ü—Ä–æ–≤–µ—Ä—å –±–∞–ª–∞–Ω—Å Telegram Stars
‚ùì –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è? –ü–æ–¥–æ–∂–¥–∏ 1-2 –º–∏–Ω—É—Ç—ã –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
‚ùì –ù—É–∂–Ω–∞ –∞–¥–º–∏–Ω-—Ä–æ–ª—å? –°–≤—è–∂–∏—Å—å —Å –∫–æ–º–∞–Ω–¥–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    """
    bot.send_message(message.chat.id, support_text, parse_mode='Markdown')

# ============================================================
# –ö–û–ú–ê–ù–î–ê /admin - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
# ============================================================
@bot.message_handler(commands=['admin'])
def admin_panel(message):
    """–î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏"""
    user_id = message.from_user.id

    if user_id not in ADMIN_IDS:
        bot.send_message(message.chat.id, "‚ùå –£ —Ç–µ–±—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.")
        return

    admin_text = """
üîê **–ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨**

–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
1. ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
2. ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–µ–ª—ã–º —Å–ø–∏—Å–∫–æ–º
3. ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã

üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–û—Ç–∫—Ä–æ–π—Ç–µ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Legion Chain Pro, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–æ–ª–Ω–æ–π –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.
    """
    bot.send_message(message.chat.id, admin_text, parse_mode='Markdown')

# ============================================================
# –û–ë–†–ê–ë–û–¢–ö–ê –û–°–¢–ê–õ–¨–ù–´–• –°–û–û–ë–©–ï–ù–ò–ô
# ============================================================
@bot.message_handler(func=lambda message: True)
def handle_text(message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
    response = """
üëã –ü—Ä–∏–≤–µ—Ç! –Ø Legion Chain Pro Bot.

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
/start - –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
/info - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–ø–∏—Å–∫–∞—Ö
/help - –°–ø—Ä–∞–≤–∫–∞
/support - –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ù–∞–∂–º–∏ /start, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å!
    """
    bot.send_message(message.chat.id, response)

# ============================================================
# –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –ó–ê–ü–£–°–ö –ë–û–¢–ê
# ============================================================
if __name__ == '__main__':
    print("=" * 60)
    print("LEGION CHAIN PRO - TELEGRAM BOT (HEROKU)")
    print("=" * 60)
    print(f"üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print("üì° –°–ª—É—à–∞—é –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è...")
    print("=" * 60)
    print()
    print("–ù–æ–≤—ã–µ —Ü–µ–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫:")
    print("  STARTER: 700 ‚≠ê (7 –¥–Ω–µ–π)")
    print("  PROFESSIONAL: 1000 ‚≠ê (14 –¥–Ω–µ–π)")
    print("  ENTERPRISE: 1500 ‚≠ê (30 –¥–Ω–µ–π)")
    print()
    print("–ö–æ–º–∞–Ω–¥—ã:")
    print("  /start - –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ")
    print("  /info - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–ø–∏—Å–∫–∞—Ö")
    print("  /help - –°–ø—Ä–∞–≤–∫–∞")
    print("  /admin - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å")
    print("=" * 60)

    try:
        bot.polling()
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞: {e}")
        print("–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –±–æ—Ç–∞...")
